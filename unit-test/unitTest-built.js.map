{"version":3,"file":"unitTest-built.js","sources":["../src/mvvm/handlers.js","../src/mvvm/observer.js","../src/mvvm/directive.js","../src/mvvm/compile.js","unitTest.js"],"sourcesContent":["/**\n * Depend 处理 Handler 的添加、删除\n */\nexport default class Handlers {\n  constructor() {\n    this._cache = []\n  }\n  /**\n   * addHandler 添加一个回调函数\n   * @param {Function} handler 回调函数\n   * @returns {undefined}\n   */\n  addHandler(handler) {\n    this._cache.push(handler)\n  }\n\n\n  notify(prop) {\n    this._cache.forEach((x) => x(prop))\n  }\n\n  destroy() {\n    this._cache = []\n  }\n}\n","import Handlers from './handlers'\n\n/** 用于存放数据 */\nconst PRIVATE_DATA_KEY = '__observe__'\n/** 用于在代理对象中存放 handlers */\nconst HANDLERS_KEY = `${PRIVATE_DATA_KEY}.__handlers__`\n/** 用于在代理对象中存放 property */\nconst PROP_KEY = `${PRIVATE_DATA_KEY}.__property__`\n\n/** array 代理操作 */\nconst ARRAY_ORP = ['push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse']\n\n/**\n * Observer 实现了对象的深度观察\n */\nexport default class Observer {\n  constructor(data) {\n    this._data = data\n    Observer._observeObj(this._data)\n  }\n  static _observeObj(data) {\n    if (typeof data !== 'object') {\n      throw new TypeError('argument data must be object')\n    }\n    Object.keys(data).forEach((prop) => {\n      defineProperty(data, prop, data[prop])\n      if (typeof data[prop] === 'object') {\n        Observer._observeObj(data[prop])\n        // 嵌套的子对象的属性在发生变化时会通知父亲对象\n        data[prop][HANDLERS_KEY].addHandler((childprop) => data[HANDLERS_KEY].notify(`${prop}.${childprop}`))\n      }\n      // array 操作也会通知\n      if (Array.isArray(data[prop])) {\n        ARRAY_ORP.forEach((opt) => {\n          const arrayTarget = data[PROP_KEY][prop]\n          arrayTarget[opt] = function () {\n            Array.prototype[opt].apply(arrayTarget, arguments)\n            data[HANDLERS_KEY].notify(prop)\n          }\n        })\n      }\n    })\n  }\n  /**\n   * 外部观察接口\n   * @param {Function} callback 回调函数\n   * @returns {undefined}\n   */\n  onChange(callback) {\n    this._data[HANDLERS_KEY].addHandler(callback)\n  }\n  data() {\n    return this._data\n  }\n  /**\n   * @param {string} key parentkey.childkey 形式\n   * @returns {any} value\n   */\n  get(key) {\n    const keys = key.split('.')\n    const ctxkeys = keys.slice(0, keys.length - 1)\n    let ctx = this._data\n    ctxkeys.forEach(\n      (x) => {\n        ctx = ctx[x]\n      }\n    )\n    return ctx[keys[keys.length - 1]]\n  }\n  /**\n   * @param {string} key parentkey.childkey 形式\n   * @param {any}  value 值\n   * @returns {undefined}\n   */\n  set(key, value) {\n    const keys = key.split('.')\n    const ctxkeys = keys.slice(0, keys.length - 1)\n    let ctx = this._data\n    ctxkeys.forEach(\n      (x) => {\n        ctx = ctx[x]\n      }\n    )\n    ctx[keys[keys.length - 1]] = value\n  }\n}\n\n/**\n * @param {Object} obj 观察者对象\n * @param {string} prop 需要观察的属性\n * @param {any} val 需要观察属性的初始化值\n * @returns {undefined}\n */\nexport function defineProperty(obj, prop, val) {\n  if (prop === PRIVATE_DATA_KEY) {\n    throw new Error('cannot define private property')\n  }\n  if (typeof val === 'undefined') {\n    val = obj[prop]\n  }\n  if (typeof obj[HANDLERS_KEY] === 'undefined') {\n    obj[HANDLERS_KEY] = new Handlers()\n  }\n  if (typeof obj[PROP_KEY] === 'undefined') {\n    obj[PROP_KEY] = {}\n  }\n  const handlers = obj[HANDLERS_KEY]\n  obj[PROP_KEY][prop] = val\n  Object.defineProperty(obj, prop, {\n    get() {\n      return obj[PROP_KEY][prop]\n    },\n    set(newVal) {\n      if (newVal !== obj[PROP_KEY][prop]) {\n        obj[PROP_KEY][prop] = newVal\n        handlers.notify(prop)\n      }\n    }\n  })\n}\n","export const PREFIX = 'sp-'\n\nexport default class Directive {\n  constructor(raw, scope) {\n    this._scope = scope\n    this._raw = raw\n  }\n  bind() {\n    return null\n  }\n  update() {\n    return null\n  }\n}\n\n// sp-text 指令 后续需要加入 XSS 防范\nexport class TextDirective extends Directive {\n  static New(raw, scope) {\n    return new TextDirective(raw, scope)\n  }\n  /**\n   * 同步数据模型到视图的单向绑定\n   * @param {Observer} observable 可观察的对象\n   * @returns {undefined}\n   */\n  bind(observable) {\n    this._scope.el.innerHTML = observable.get(this._raw)\n    observable.onChange((key) => {\n      if (key === this._raw) {\n        this._scope.el.innerHTML = observable.get(key)\n      }\n    })\n  }\n}\n\n// sp-bind 指令\nexport class InputBindDirective extends Directive {\n  static New(raw, scope) {\n    return new InputBindDirective(raw, scope)\n  }\n  /**\n   * 表单到模型的双向绑定\n   * @param {Observer} observable 可观察的对象\n   * @returns {undefined}\n   */\n  bind(observable) {\n    this._scope.el.value = observable.get(this._raw)\n    observable.onChange((key) => {\n      if (key === this._raw) {\n        this._scope.el.value = observable.get(key)\n      }\n    })\n    this._scope.el.addEventListener('input', () => {\n      observable.set(this._raw, this._scope.el.value)\n    })\n  }\n}\n\n/**\n * 索引\n */\nexport const DIRECTIVES = {\n  bind: InputBindDirective,\n  text: TextDirective\n}\n","import {PREFIX, DIRECTIVES} from './directive'\n\nconst DIRECTIVE_PATTERN = new RegExp(`${PREFIX}(\\\\w+)`)\n/**\n * @param {HTMLElement} element 文档节点\n * @param {Observer} observerable 绑定到的数据模型\n * @returns {undefined}\n */\nexport function compileTemplate(element, observerable) {\n  if (element.children && element.children.length > 0) {\n    Array.from(element.children).forEach((el) => {\n      parseElement(el, observerable)\n      compileTemplate(el, observerable)\n    })\n  }\n}\n\n/**\n * 解析指令\n * @param {HTMLElement} el 需要解析的文档节点\n * @param {Object} observerable 数据模型\n * @returns {undefined}\n */\nfunction parseElement(el, observerable) {\n  const attributes = Array.from(el.attributes) || []\n  const scope = {\n    parentNode: el.parentElement,\n    nextNode: el.nextElementSibling,\n    el\n  }\n  attributes.forEach((attr) => {\n    const raw = attr.value\n    const directiveName = isDirecitve(attr.name)\n    const directiveType = directiveName && DIRECTIVES[directiveName]\n    if (directiveName && directiveType) {\n      const directive = directiveType.New(raw, scope)\n      directive.bind(observerable)\n    }\n  })\n}\n\n/**\n * @param {string} attr 指令\n * @returns {string} 匹配到的字符\n */\nexport function isDirecitve(attr) {\n  const matchResult = attr.match(DIRECTIVE_PATTERN)\n  return matchResult && matchResult[1] || ''\n}\n","import Observer from '../src/mvvm/observer'\r\nimport { TextDirective, InputBindDirective} from '../src/mvvm/directive'\r\nimport {compileTemplate} from '../src/mvvm/compile'\r\n// 观察者单元测试\r\ndescribe('observer', function(){\r\n    it('set prop properly', function () {\r\n        let o = new Observer({\r\n            users: [0, 1, 2, 3],\r\n            key: 'val'\r\n        })\r\n        let data = o.data()\r\n        expect(data.key).toBe('val')\r\n    })\r\n    it('primitive prop change', function(){\r\n        let changed = false\r\n        let o = new Observer({\r\n            users: [0, 1, 2, 3],\r\n            key: 'val'\r\n        })\r\n        let data = o.data()\r\n        o.onChange(function(prop){\r\n            if(prop === 'key'){\r\n                changed = true\r\n            }\r\n        })\r\n        data.key = 'val.'\r\n        expect(changed).toBe(true)\r\n    })\r\n    it('primitive prop not change', function () {\r\n        let changed = false\r\n        let o = new Observer({\r\n            users: [0, 1, 2, 3],\r\n            key: 'val'\r\n        })\r\n        let data = o.data()\r\n        o.onChange(function (prop) {\r\n            if (prop === 'key') {\r\n                changed = true\r\n            }\r\n        })\r\n        data.key = 'val'\r\n        expect(changed).toBe(false)\r\n    })\r\n    it('object prop change', function () {\r\n        let changed = false\r\n        let o = new Observer({\r\n            users: [0, 1, 2, 3],\r\n            key: 'val',\r\n            o: {\r\n                key: 'val'\r\n            }\r\n        })\r\n        let data = o.data()\r\n        o.onChange(function (prop) {\r\n            if (prop === 'o.key') {\r\n                changed = true\r\n            }\r\n        })\r\n        data.o.key = 'val.'\r\n        expect(changed).toBe(true)\r\n    })       \r\n    it('observe array prop change', function () {\r\n        let changed = false\r\n        let o = new Observer({\r\n            users: [0, 1, 2, 3],\r\n            key: 'val'\r\n        })\r\n        let data = o.data()\r\n        o.onChange(function (prop) {\r\n            if (prop === 'users') {\r\n                changed = true\r\n            }\r\n        })\r\n        data.users.push('val.')\r\n        expect(data.users.push === Array.prototype.push).toBe(false)\r\n        expect(changed).toBe(true)\r\n    })\r\n    it('get value', function(){\r\n        let o = new Observer({\r\n                key1 : {\r\n                    key2 : {\r\n                        key3: '3'\r\n                    }\r\n                }\r\n            }\r\n        )\r\n        expect(o.get('key1.key2.key3')).toBe('3')\r\n        expect(o.get('key1.key2.key3')).toBe(o.data().key1.key2.key3)\r\n    })\r\n    it('set value', function () {\r\n        let o = new Observer({\r\n            key1: {\r\n                key2: {\r\n                    key3: '3'\r\n                }\r\n            }\r\n        }\r\n        )\r\n        o.set('key1.key2.key3', 4)\r\n        expect(o.get('key1.key2.key3')).toBe(4)\r\n    })\r\n})\r\n\r\n// 指令绑定单元测试\r\ndescribe('directive', function(){\r\n    it('text directive', function(){\r\n        let el = document.createElement('div')\r\n        let textdirective = new TextDirective('key1.key2', {\r\n            el: el\r\n        })\r\n        let o = new Observer({\r\n            key1: {\r\n                key2 : 'key2'\r\n            }\r\n        })\r\n        textdirective.bind(o)\r\n        expect(el.innerHTML).toBe('key2')\r\n        o.data().key1.key2 = 'key3'\r\n        expect(el.innerHTML).toBe('key3')\r\n    })\r\n\r\n    it('input directive', function () {\r\n        let el = document.createElement('input')\r\n        el.setAttribute('type', 'text')\r\n        document.body.appendChild(el)\r\n        let inputdirective = new InputBindDirective('key1.key2', {\r\n            el: el\r\n        })\r\n        let o = new Observer({\r\n            key1: {\r\n                key2: 'key2'\r\n            }\r\n        })\r\n        inputdirective.bind(o)\r\n        expect(el.value).toBe('key2')\r\n        o.data().key1.key2 = 'key3'\r\n        expect(el.value).toBe('key3')\r\n    })\r\n    it('composite directive', function(){\r\n        let el = document.createElement('div')\r\n        el.innerHTML = `\r\n            <input type=\"text\" sp-bind=\"username\">\r\n            <h1 sp-text=\"username\"></h1>\r\n        `\r\n        let o = new Observer({\r\n            username: 'salpadding'\r\n        })\r\n        document.body.appendChild(el)\r\n        compileTemplate(el, o)\r\n        expect(el.querySelector('input').value).toBe('salpadding')\r\n        expect(el.querySelector('h1').innerHTML).toBe('salpadding')\r\n    })\r\n})\r\n\r\n\r\n\r\n"],"names":["Handlers","_cache","handler","push","prop","forEach","x","PRIVATE_DATA_KEY","HANDLERS_KEY","PROP_KEY","ARRAY_ORP","Observer","data","_data","_observeObj","TypeError","keys","addHandler","childprop","notify","Array","isArray","opt","arrayTarget","prototype","apply","arguments","callback","key","split","ctxkeys","slice","length","ctx","value","defineProperty","obj","val","Error","handlers","newVal","PREFIX","Directive","raw","scope","_scope","_raw","TextDirective","New","observable","el","innerHTML","get","onChange","InputBindDirective","addEventListener","set","DIRECTIVES","DIRECTIVE_PATTERN","RegExp","compileTemplate","element","observerable","children","from","parseElement","attributes","parentElement","nextElementSibling","attr","directiveName","isDirecitve","name","directiveType","directive","bind","matchResult","match","describe","o","toBe","changed","users","key1","key2","key3","document","createElement","textdirective","setAttribute","body","appendChild","inputdirective","querySelector"],"mappings":";;;;;;AAAA;;;AAGA,AAAe,MAAMA,QAAN,CAAe;gBACd;SACPC,MAAL,GAAc,EAAd;;;;;;;;;aAOSC,OAAX,EAAoB;SACbD,MAAL,CAAYE,IAAZ,CAAiBD,OAAjB;;;SAIKE,IAAP,EAAa;SACNH,MAAL,CAAYI,OAAZ,CAAqBC,CAAD,IAAOA,EAAEF,IAAF,CAA3B;;;YAGQ;SACHH,MAAL,GAAc,EAAd;;;;;ACpBJ;;AACA,MAAMM,mBAAmB,aAAzB;;;AAEA,MAAMC,eAAgB,GAAED,gBAAiB,eAAzC;;;AAEA,MAAME,WAAY,GAAEF,gBAAiB,eAArC;;;AAGA,MAAMG,YAAY,CAAC,MAAD,EAAS,KAAT,EAAgB,OAAhB,EAAyB,SAAzB,EAAoC,QAApC,EAA8C,MAA9C,EAAsD,SAAtD,CAAlB;;;;;AAKA,AAAe,MAAMC,QAAN,CAAe;cAChBC,IAAZ,EAAkB;SACXC,KAAL,GAAaD,IAAb;;aACSE,WAAT,CAAqB,KAAKD,KAA1B;;;SAEKC,WAAP,CAAmBF,IAAnB,EAAyB;QACnB,OAAOA,IAAP,KAAgB,QAApB,EAA8B;YACtB,IAAIG,SAAJ,CAAc,8BAAd,CAAN;;;WAEKC,IAAP,CAAYJ,IAAZ,EAAkBP,OAAlB,CAA2BD,IAAD,IAAU;qBACnBQ,IAAf,EAAqBR,IAArB,EAA2BQ,KAAKR,IAAL,CAA3B;;UACI,OAAOQ,KAAKR,IAAL,CAAP,KAAsB,QAA1B,EAAoC;iBACzBU,WAAT,CAAqBF,KAAKR,IAAL,CAArB,EADkC;;;aAG7BA,IAAL,EAAWI,YAAX,EAAyBS,UAAzB,CAAqCC,SAAD,IAAeN,KAAKJ,YAAL,EAAmBW,MAAnB,CAA2B,GAAEf,IAAK,IAAGc,SAAU,EAA/C,CAAnD;OALgC;;;UAQ9BE,MAAMC,OAAN,CAAcT,KAAKR,IAAL,CAAd,CAAJ,EAA+B;kBACnBC,OAAV,CAAmBiB,GAAD,IAAS;gBACnBC,cAAcX,KAAKH,QAAL,EAAeL,IAAf,CAApB;;sBACYkB,GAAZ,IAAmB,YAAY;kBACvBE,SAAN,CAAgBF,GAAhB,EAAqBG,KAArB,CAA2BF,WAA3B,EAAwCG,SAAxC;iBACKlB,YAAL,EAAmBW,MAAnB,CAA0Bf,IAA1B;WAFF;SAFF;;KATJ;;;;;;;;;WAwBOuB,QAAT,EAAmB;SACZd,KAAL,CAAWL,YAAX,EAAyBS,UAAzB,CAAoCU,QAApC;;;SAEK;WACE,KAAKd,KAAZ;;;;;;;;MAMEe,GAAJ,EAAS;UACDZ,OAAOY,IAAIC,KAAJ,CAAU,GAAV,CAAb;UACMC,UAAUd,KAAKe,KAAL,CAAW,CAAX,EAAcf,KAAKgB,MAAL,GAAc,CAA5B,CAAhB;QACIC,MAAM,KAAKpB,KAAf;YACQR,OAAR,CACGC,CAAD,IAAO;YACC2B,IAAI3B,CAAJ,CAAN;KAFJ;WAKO2B,IAAIjB,KAAKA,KAAKgB,MAAL,GAAc,CAAnB,CAAJ,CAAP;;;;;;;;;MAOEJ,GAAJ,EAASM,KAAT,EAAgB;UACRlB,OAAOY,IAAIC,KAAJ,CAAU,GAAV,CAAb;UACMC,UAAUd,KAAKe,KAAL,CAAW,CAAX,EAAcf,KAAKgB,MAAL,GAAc,CAA5B,CAAhB;QACIC,MAAM,KAAKpB,KAAf;YACQR,OAAR,CACGC,CAAD,IAAO;YACC2B,IAAI3B,CAAJ,CAAN;KAFJ;QAKIU,KAAKA,KAAKgB,MAAL,GAAc,CAAnB,CAAJ,IAA6BE,KAA7B;;;;;;;;;;;AAUJ,AAAO,SAASC,cAAT,CAAwBC,GAAxB,EAA6BhC,IAA7B,EAAmCiC,GAAnC,EAAwC;MACzCjC,SAASG,gBAAb,EAA+B;UACvB,IAAI+B,KAAJ,CAAU,gCAAV,CAAN;;;MAEE,OAAOD,GAAP,KAAe,WAAnB,EAAgC;UACxBD,IAAIhC,IAAJ,CAAN;;;MAEE,OAAOgC,IAAI5B,YAAJ,CAAP,KAA6B,WAAjC,EAA8C;QACxCA,YAAJ,IAAoB,IAAIR,QAAJ,EAApB;;;MAEE,OAAOoC,IAAI3B,QAAJ,CAAP,KAAyB,WAA7B,EAA0C;QACpCA,QAAJ,IAAgB,EAAhB;;;QAEI8B,WAAWH,IAAI5B,YAAJ,CAAjB;MACIC,QAAJ,EAAcL,IAAd,IAAsBiC,GAAtB;SACOF,cAAP,CAAsBC,GAAtB,EAA2BhC,IAA3B,EAAiC;UACzB;aACGgC,IAAI3B,QAAJ,EAAcL,IAAd,CAAP;KAF6B;;QAI3BoC,MAAJ,EAAY;UACNA,WAAWJ,IAAI3B,QAAJ,EAAcL,IAAd,CAAf,EAAoC;YAC9BK,QAAJ,EAAcL,IAAd,IAAsBoC,MAAtB;iBACSrB,MAAT,CAAgBf,IAAhB;;;;GAPN;;;AC5GK,MAAMqC,SAAS,KAAf;AAEP,AAAe,MAAMC,SAAN,CAAgB;cACjBC,GAAZ,EAAiBC,KAAjB,EAAwB;SACjBC,MAAL,GAAcD,KAAd;SACKE,IAAL,GAAYH,GAAZ;;;SAEK;WACE,IAAP;;;WAEO;WACA,IAAP;;;;;AAKJ,AAAO,MAAMI,aAAN,SAA4BL,SAA5B,CAAsC;SACpCM,GAAP,CAAWL,GAAX,EAAgBC,KAAhB,EAAuB;WACd,IAAIG,aAAJ,CAAkBJ,GAAlB,EAAuBC,KAAvB,CAAP;;;;;;;;;OAOGK,UAAL,EAAiB;SACVJ,MAAL,CAAYK,EAAZ,CAAeC,SAAf,GAA2BF,WAAWG,GAAX,CAAe,KAAKN,IAApB,CAA3B;eACWO,QAAX,CAAqBzB,GAAD,IAAS;UACvBA,QAAQ,KAAKkB,IAAjB,EAAuB;aAChBD,MAAL,CAAYK,EAAZ,CAAeC,SAAf,GAA2BF,WAAWG,GAAX,CAAexB,GAAf,CAA3B;;KAFJ;;;;;AASJ,AAAO,MAAM0B,kBAAN,SAAiCZ,SAAjC,CAA2C;SACzCM,GAAP,CAAWL,GAAX,EAAgBC,KAAhB,EAAuB;WACd,IAAIU,kBAAJ,CAAuBX,GAAvB,EAA4BC,KAA5B,CAAP;;;;;;;;;OAOGK,UAAL,EAAiB;SACVJ,MAAL,CAAYK,EAAZ,CAAehB,KAAf,GAAuBe,WAAWG,GAAX,CAAe,KAAKN,IAApB,CAAvB;eACWO,QAAX,CAAqBzB,GAAD,IAAS;UACvBA,QAAQ,KAAKkB,IAAjB,EAAuB;aAChBD,MAAL,CAAYK,EAAZ,CAAehB,KAAf,GAAuBe,WAAWG,GAAX,CAAexB,GAAf,CAAvB;;KAFJ;;SAKKiB,MAAL,CAAYK,EAAZ,CAAeK,gBAAf,CAAgC,OAAhC,EAAyC,MAAM;iBAClCC,GAAX,CAAe,KAAKV,IAApB,EAA0B,KAAKD,MAAL,CAAYK,EAAZ,CAAehB,KAAzC;KADF;;;;;;;;AASJ,AAAO,MAAMuB,aAAa;QAClBH,kBADkB;QAElBP;CAFD;;AC3DP,MAAMW,oBAAoB,IAAIC,MAAJ,CAAY,GAAElB,MAAO,QAArB,CAA1B;;;;;;;AAMA,AAAO,SAASmB,eAAT,CAAyBC,OAAzB,EAAkCC,YAAlC,EAAgD;MACjDD,QAAQE,QAAR,IAAoBF,QAAQE,QAAR,CAAiB/B,MAAjB,GAA0B,CAAlD,EAAqD;UAC7CgC,IAAN,CAAWH,QAAQE,QAAnB,EAA6B1D,OAA7B,CAAsC6C,EAAD,IAAQ;mBAC9BA,EAAb,EAAiBY,YAAjB;sBACgBZ,EAAhB,EAAoBY,YAApB;KAFF;;;;;;;;;;AAaJ,SAASG,YAAT,CAAsBf,EAAtB,EAA0BY,YAA1B,EAAwC;QAChCI,aAAa9C,MAAM4C,IAAN,CAAWd,GAAGgB,UAAd,KAA6B,EAAhD;QACMtB,QAAQ;gBACAM,GAAGiB,aADH;cAEFjB,GAAGkB,kBAFD;;GAAd;aAKW/D,OAAX,CAAoBgE,IAAD,IAAU;UACrB1B,MAAM0B,KAAKnC,KAAjB;UACMoC,gBAAgBC,YAAYF,KAAKG,IAAjB,CAAtB;UACMC,gBAAgBH,iBAAiBb,WAAWa,aAAX,CAAvC;;QACIA,iBAAiBG,aAArB,EAAoC;YAC5BC,YAAYD,cAAczB,GAAd,CAAkBL,GAAlB,EAAuBC,KAAvB,CAAlB;gBACU+B,IAAV,CAAeb,YAAf;;GANJ;;;;;;;;AAeF,AAAO,SAASS,WAAT,CAAqBF,IAArB,EAA2B;QAC1BO,cAAcP,KAAKQ,KAAL,CAAWnB,iBAAX,CAApB;SACOkB,eAAeA,YAAY,CAAZ,CAAf,IAAiC,EAAxC;;;AC3CFE,SAAS,UAAT,EAAqB,YAAU;KACxB,mBAAH,EAAwB,YAAY;QAC5BC,IAAI,IAAIpE,QAAJ,CAAa;aACV,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CADU;WAEZ;KAFD,CAAR;QAIIC,OAAOmE,EAAEnE,IAAF,EAAX;WACOA,KAAKgB,GAAZ,EAAiBoD,IAAjB,CAAsB,KAAtB;GANJ;KAQG,uBAAH,EAA4B,YAAU;QAC9BC,UAAU,KAAd;QACIF,IAAI,IAAIpE,QAAJ,CAAa;aACV,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CADU;WAEZ;KAFD,CAAR;QAIIC,OAAOmE,EAAEnE,IAAF,EAAX;MACEyC,QAAF,CAAW,UAASjD,IAAT,EAAc;UAClBA,SAAS,KAAZ,EAAkB;kBACJ,IAAV;;KAFR;SAKKwB,GAAL,GAAW,MAAX;WACOqD,OAAP,EAAgBD,IAAhB,CAAqB,IAArB;GAbJ;KAeG,2BAAH,EAAgC,YAAY;QACpCC,UAAU,KAAd;QACIF,IAAI,IAAIpE,QAAJ,CAAa;aACV,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CADU;WAEZ;KAFD,CAAR;QAIIC,OAAOmE,EAAEnE,IAAF,EAAX;MACEyC,QAAF,CAAW,UAAUjD,IAAV,EAAgB;UACnBA,SAAS,KAAb,EAAoB;kBACN,IAAV;;KAFR;SAKKwB,GAAL,GAAW,KAAX;WACOqD,OAAP,EAAgBD,IAAhB,CAAqB,KAArB;GAbJ;KAeG,oBAAH,EAAyB,YAAY;QAC7BC,UAAU,KAAd;QACIF,IAAI,IAAIpE,QAAJ,CAAa;aACV,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CADU;WAEZ,KAFY;SAGd;aACM;;KAJL,CAAR;QAOIC,OAAOmE,EAAEnE,IAAF,EAAX;MACEyC,QAAF,CAAW,UAAUjD,IAAV,EAAgB;UACnBA,SAAS,OAAb,EAAsB;kBACR,IAAV;;KAFR;SAKK2E,CAAL,CAAOnD,GAAP,GAAa,MAAb;WACOqD,OAAP,EAAgBD,IAAhB,CAAqB,IAArB;GAhBJ;KAkBG,2BAAH,EAAgC,YAAY;QACpCC,UAAU,KAAd;QACIF,IAAI,IAAIpE,QAAJ,CAAa;aACV,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CADU;WAEZ;KAFD,CAAR;QAIIC,OAAOmE,EAAEnE,IAAF,EAAX;MACEyC,QAAF,CAAW,UAAUjD,IAAV,EAAgB;UACnBA,SAAS,OAAb,EAAsB;kBACR,IAAV;;KAFR;SAKK8E,KAAL,CAAW/E,IAAX,CAAgB,MAAhB;WACOS,KAAKsE,KAAL,CAAW/E,IAAX,KAAoBiB,MAAMI,SAAN,CAAgBrB,IAA3C,EAAiD6E,IAAjD,CAAsD,KAAtD;WACOC,OAAP,EAAgBD,IAAhB,CAAqB,IAArB;GAdJ;KAgBG,WAAH,EAAgB,YAAU;QAClBD,IAAI,IAAIpE,QAAJ,CAAa;YACN;cACI;gBACG;;;KAHd,CAAR;WAQOoE,EAAE3B,GAAF,CAAM,gBAAN,CAAP,EAAgC4B,IAAhC,CAAqC,GAArC;WACOD,EAAE3B,GAAF,CAAM,gBAAN,CAAP,EAAgC4B,IAAhC,CAAqCD,EAAEnE,IAAF,GAASuE,IAAT,CAAcC,IAAd,CAAmBC,IAAxD;GAVJ;KAYG,WAAH,EAAgB,YAAY;QACpBN,IAAI,IAAIpE,QAAJ,CAAa;YACX;cACI;gBACI;;;KAHV,CAAR;MAQE6C,GAAF,CAAM,gBAAN,EAAwB,CAAxB;WACOuB,EAAE3B,GAAF,CAAM,gBAAN,CAAP,EAAgC4B,IAAhC,CAAqC,CAArC;GAVJ;CArFJ;;AAoGAF,SAAS,WAAT,EAAsB,YAAU;KACzB,gBAAH,EAAqB,YAAU;QACvB5B,KAAKoC,SAASC,aAAT,CAAuB,KAAvB,CAAT;QACIC,gBAAgB,IAAIzC,aAAJ,CAAkB,WAAlB,EAA+B;UAC3CG;KADY,CAApB;QAGI6B,IAAI,IAAIpE,QAAJ,CAAa;YACX;cACK;;KAFP,CAAR;kBAKcgE,IAAd,CAAmBI,CAAnB;WACO7B,GAAGC,SAAV,EAAqB6B,IAArB,CAA0B,MAA1B;MACEpE,IAAF,GAASuE,IAAT,CAAcC,IAAd,GAAqB,MAArB;WACOlC,GAAGC,SAAV,EAAqB6B,IAArB,CAA0B,MAA1B;GAbJ;KAgBG,iBAAH,EAAsB,YAAY;QAC1B9B,KAAKoC,SAASC,aAAT,CAAuB,OAAvB,CAAT;OACGE,YAAH,CAAgB,MAAhB,EAAwB,MAAxB;aACSC,IAAT,CAAcC,WAAd,CAA0BzC,EAA1B;QACI0C,iBAAiB,IAAItC,kBAAJ,CAAuB,WAAvB,EAAoC;UACjDJ;KADa,CAArB;QAGI6B,IAAI,IAAIpE,QAAJ,CAAa;YACX;cACI;;KAFN,CAAR;mBAKegE,IAAf,CAAoBI,CAApB;WACO7B,GAAGhB,KAAV,EAAiB8C,IAAjB,CAAsB,MAAtB;MACEpE,IAAF,GAASuE,IAAT,CAAcC,IAAd,GAAqB,MAArB;WACOlC,GAAGhB,KAAV,EAAiB8C,IAAjB,CAAsB,MAAtB;GAfJ;KAiBG,qBAAH,EAA0B,YAAU;QAC5B9B,KAAKoC,SAASC,aAAT,CAAuB,KAAvB,CAAT;OACGpC,SAAH,GAAgB;;;SAAhB;QAII4B,IAAI,IAAIpE,QAAJ,CAAa;gBACP;KADN,CAAR;aAGS+E,IAAT,CAAcC,WAAd,CAA0BzC,EAA1B;oBACgBA,EAAhB,EAAoB6B,CAApB;WACO7B,GAAG2C,aAAH,CAAiB,OAAjB,EAA0B3D,KAAjC,EAAwC8C,IAAxC,CAA6C,YAA7C;WACO9B,GAAG2C,aAAH,CAAiB,IAAjB,EAAuB1C,SAA9B,EAAyC6B,IAAzC,CAA8C,YAA9C;GAZJ;CAlCJ;;;;"}